
<div class='col-lg-12 offset-lg-2 d-none d-lg-block' style="margin-top: 20px !important">
  <span class="" style='font-size: 1.4rem; font-weight: 600; '>
    <%= @group.name %>
  </span>
</div>

<%= render partial: 'nav' %>

<div class="container-fluid" >
  <div class="row">
    <div class="col-md-12">
      <ol class="breadcrumb"id="dark-container">
        <li class="breadcrumb-item"><%=link_to "HOME", root_path %></li>
        <li class="breadcrumb-item active" aria-current="page"><%if @group.name != nil%><%= @group.name %><%else%><%=@group.billing_id%><%end%></li>
      </ol>
      <p id="notice"><%= notice %></p>
    </div>
    <div class="col-md-6">
    </div>
  </div>
</div>

<% if flash[:member_contact_errors] %>
  <span style="font-size: 1.3rem; font-weight: 500">Could not submit changes for the following reasons:</span>
  <div class="alert alert-danger" role="alert">
    <% flash[:member_contact_errors].each do |msg| %>
      <span style="font-size: 1rem; font-weight: 500"><%= msg %></span>
    <% end %>
  </div>
<% end %>


<div class="container-fluid" >
  <div class="row" >
    <div class='col-md-8 offset-md-1 d-lg-none'>
      <span class="text-center">
        <%= @group.name %>
      </span>
    </div>

    <!-- Loading Member Codes -->
    <div class="col-md-8 offset-md-1">
      <div class="container-fluid" style="padding-top: 35px !important">
        <span style="font-size: 1.3rem; font-weight: 500" class="text-center">Codes</span>
        <hr class="my-4">
        </hr>
        <div
          data-controller="content-loader"
          data-content-loader-url-value="<%= member_detail_list_path(billing_id: @group.billing_id, group_id: @group.id) %>">
          <i class="fas fa-spinner fa-spin"></i> Loading member codes...
        </div>
      </div>
    </div>
    <!-- Loading Member Codes -->

    <div class="col-md-3">
      <div class="mycontent-right">

        <!-- SAR Upload -->
        <div style="padding-left: 15px; padding-top:15px">
          <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#service_area_modal" >
            Upload SAR
          </button>
          <div class="collapse" id="service_area_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <span style="font-size: 1.1rem; font-weight: 500" class="modal-title" id="service_area_modal">Upload SAR</span>

                </div>
                <div class="modal-body">


                </div>

              </div>
            </div>
          </div>
          <script>
              EmbedManager.embed({
                  key: "https://fs26.formsite.com/res/showFormEmbed?EParam=m_OmK8apOTANZkOaL7H0HogAwUXi0cBCFzpUCZwnDno&900522022",
                  width: "100%",
                  mobileResponsive: true,
                  prePopulate: {"1":"<%= current_user.profile.first_name%>","2":"<%= current_user.profile.last_name%>","3":"<%= current_user.email%>"}
              });
          </script>
        </div>
        <br/>
        <!-- SAR Upload -->

        <!-- Recent Activity Log -->
        <%= turbo_stream_from 'member_contacts' %>
        <span style="font-size: 1rem; font-weight: 500" >Recent Activity</span>
        <ul class="list-group" >
          <%= turbo_frame_tag 'member_contacts' do %>
            <%= render partial: 'member_contacts/member_contact', locals: { billing_id: @group.billing_id} %>
            <%if @activities.present?%>
              <% @activities.each do |activity| %>
                <li class="list-group-item" >
                  <%= "#{activity.owner.profile.first_name} #{activity.owner.profile.last_name}" if activity.owner %>
                  <%= {'UPDATE' => ' Updated a ', 'DELETE' => 'Deleted a', 'INSERT' => 'Added a'}.fetch(activity.stype) %>
                  <%= @contact_types.fetch(activity.contact_type) %> contact for
                  <%= activity.code %>
                  on <%=activity.updated_at.localtime.strftime("%m/%d at %I:%M %p") %>
                </li>
              <% end %>
            <%end%>
          <% end %>
        </ul>
        <!-- Recent Activity Log -->

      </div>
    </div>
  </div>
</div>


<div id="questionmodal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <span style="font-size: 1.3rem; font-weight: 500" class="modal-title">Contact Types</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <ul>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Member Representative Contact (REPR, MEMBER REP)</b> &nbsp; The sole Representative of your company, that must approve any changes to your membership in order for it to take effect.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Billing Contact (BILL, BILLING)</b> &nbsp; The person to contact for any billing related issues and will receive your membership billing invoice.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Marking Contact (RCVR, RECEIVING)</b> &nbsp; Person or office that receives tickets during traditional business hours. Answers questions from excavators about markings (or can contact specific field locating technician to assign technician to answer questions).</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>General Questions Contact (CONT, CONTACT)</b> &nbsp;  The person that will receive general questions regarding dig tickets your company is notified on.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Emergency/Facility Dig-in (EMERG, EMERGENCY) Contact</b> &nbsp; The person the excavator will reach out to regarding any emergency or a damaged facility scenario.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Engineer/Service Area Contact (ENGR, ENGINEERING)</b> &nbsp; The individual within your company who is authorized to make changes to your companyâ€™s Service Area Registration (SAR).</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Vacuum Contact (VACU, VACUUM)</b> &nbsp; The person to contact if an excavator will be exposing your facilities using vacuum equipment.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>After Hours (AHRS, AFTER HOURS) Contact</b> &nbsp; The person to contact during non-business hours.</span></li>
          <li><span style="font-size: 1rem; font-weight: 500"  style='text-align:left'><b>Board Minutes Contact (BORD, BOARD REPRESENTATIVE)</b> &nbsp; This person will receive the quarterly board meeting minutes.</span></li>
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>


<style type="text/css">.mycontent-right {
    border-left: 3px solid #F2F7F9 !important;
}</style>
